<details>
<summary>Table of Contents</summary>

- [함수형 프로그래밍](#functional-programming)

</details>

# functional programming   
## 프로그래밍 패러다임
* 명령형 프로그래밍 : 무엇을 할 것인지 보다 어떻게 할 건지를 설명
* 선언형 프로글밍 : 어떻게 할건지 보다 무엇을 할 건지를 설명

> 'This is the midday show with Cheryl Waters' 문자열의 모든 공백을 하이픈(-)으로 바꿔주세요.

위 요구 사항을 **명령형**으로 작성한다면?   

**원하는 결과를 달성하는 과정** :

1. 우선 문자열의 모든 루프를 돈다.
2. 공백을 만날 때마다 그 공백을 `-` 으로 바꾼다.

```javaScript
var string = 'THis is the midday show with Cheryl Waters';
var urlFriendly = "";

for(var i=0; i<string.length; i++){
    if(string[i] === " "){
        urlFriendly += "-";
    }else{
        urlFriendly += string[i];
    }
}

console.log(urlFriendly);
```

**선언형**으로 작성한다면?   
**필요한 것** : 공백이 `-` 으로 바뀐 문자열   

```javaScript
const string = 'This is the midday show with Cheryl Waters';
const urlFriendly = string.replace(/ /g, '-');

console.log(urlFriendly);
```

선언적 프로그래밍의 코드 구문은 어떤 일이 발생해야 하는지 기술하고, 실제로 그 작업을 처리하는 방법은 추상화로 아랫단에 감추어집니다.   
***많은 선언적(Declarative) 접근 방식들의 기반에는 일종의 '명령적(Imperative) 추상화'가 존재한다.***

## 함수형 프로그래밍의 등장
명령형 프로그래밍으로 개발할 경우, 코드 유지보수가 힘들다. 그래서 거의 모든 것을 순수 함수로 나누어 문제를 해결하는 함수형 프로그래밍이 등장함.

## 함수형 프로그래밍 특징
> **부수 효과**가 없는 **순수 함수**를 **1급 객체**로 간주하여 파라미터나 반환값으로 사용할 수 있으며, **참조 투명성**을 지킬 수 있다.   
 
### 부수 효과 (Side Effect)
> 함수 내의 실행으로 인해 함수 외부가 영향을 받는 것

함수의 매개 변수의 값이 변경되어, 이로 인해 함수를 사용하는 코드에 영향을 주거나, 함수의 외부 세계인 데이터베이스, 파일 시스템, 네트워크로 데이터 이동이 함수 실행 중에는 발생하지 않아야 함수형 코드가 된다.

```java
public static int add(int a, int b) {
  while (b > 0) {
    a++;
    b--;
  }
  return a;
}
```

위의 메쏘드는 함수적이다. 정수형 a, b 를 매개 변수로 받은 후, 그것들의 값을 변경하지 않고 결과를 반환한다. a, b 값을 변경한다고 해도 함수적이다. 왜냐하면 Java 에서는 원시 타입의 매개 변수는 pass by value 형태로 전달되기 때문에, 함수 내에서 값을 변경해도 함수를 벗어난 후에는 영향을 주지 않는다.

```java
public static int div(int a, int b) {
  return a / b;
}
```

위의 함수는 함수적이지 않다. b의 값이 0인 경우 divide by zero 예외가 발생하는데, 예외를 발생시키는 것은 함수적이지 않다. 위의 코드는 아래와 같이 변경할 수 있다.

```java
public static int div(int a, int b) {
  return (int) (a / (float) b);
}
```

### 순수 함수 (Pure Function)
> 부수 효과(Side Effect)들을 제거한 함수들을 순수 함수(Pure Function)이라고 부르며, 함수형 프로그래밍에서 사용하는 함수는 이러한 순수 함수들이다.   

* 장점
  * 함수 자체가 독립적이며 Side-Effect가 없기 때문에 Thread에 안전성을 보장받을 수 있다.
  * Thread에 안정성을 보장받아 병렬 처리를 동기화 없이 진행할 수 있다.

### 1급 객체 (First-Class Object)
1급 객체란 다음과 같은 것들이 가능한 객체를 의미한다.
* 변수나 데이터 구조 안에 담을 수 있다.
* 파라미터로 전달 할 수 있다.
* 반환값으로 사용할 수 있다.
* 할당에 사용된 이름과 무관하게 고유한 구별이 가능하다.   

함수형 프로그래밍에서 함수는 1급 객체로 취급받기 때문에 위의 예제에서 본 것 처럼 함수를 파라미터로 넘기는 등의 작업이 가능한 것이다. 또한 우리가 일반적으로 알고 개발했던 함수들은 함수형 프로그래밍에서 정의하는 순수 함수들과는 다르다는 것을 인지해야 한다.   

### 참조 투명성 (Referential Transparency)   
“참조 투명성”은 함수 (또는 메쏘드) 가 함수 외부의 영향을 받지 않는 것을 의미한다. 다른 말로 하면, 함수의 결과는 입력 파라미터에만 의존하고, 함수의 외부 세계인 입력 콘솔, 파일, 원격 URL, 데이터베이스, 파일 시스템 등에서 데이터를 읽지 않는다. 함수 외부의 값을 변경하거나, 외부 세계의 의존적이지 않은 코드를 가리켜 “참조 투명성 있다” 라고 말한다.   


명령형 프로그래밍과 함수형 프로그래밍에서 사용하는 함수는 부수효과의 유/무에 따라 차이가 있다. 그에 따라 함수가 참조에 투명한지 안한지 나뉘어 지는데, 참조에 투명하다는 것은 말 그대로 함수를 실행하여도 어떠한 상태의 변화 없이 항상 동일한 결과를 반환하여 항상 동일하게(투명하게) 실행 결과를 참조(예측)할 수 있다는 것을 의미한다.

즉, 어떤 함수 f에 어떠한 인자 x를 넣고 f를 실행하게 되면, f는 입력된 인자에만 의존하므로 항상 f(x)라는 동일한 결과를 얻는다는 것을 의미한다. 부작용을 제거하여 프로그램의 동작을 이해하고 예측을 용이하게 하는 것은 함수형 프로그래밍으로 개발하려는 핵심 동기 중 하나이다. 그리고 이러한 부분인 병렬 처리 환경에서 개발할 때 Race Condition에 대한 비용을 줄여준다. 왜냐하면 함수형 프로그래밍에서는 값의 대입이 없이 항상 동일한 실행에 대해 동일한 결과를 반환하기 때문이다.

### 추가 예시
단어의 리스트가 있을 때 다음과 같은 문제가 주어졌다고 하자.

1. 단어의 크기가 2 이상인 경우를 필터링한다.
2. 모든 단어를 대문자로 변환한다.
3. 모든 단어를 앞글자만 잘라내어 변환한다.
4. 모든 단어를 스페이스로 구분한 하나의 문자열로 합친다.

명령형 프로그래밍으로 하면 아주 복잡하지만 함수형 프로그래밍을 사용하면 쉽게 가능하다.


```java
public class WordProcessTest {

    private final List<String> words = Arrays.asList("TONY", "a", "hULK", "B", "america", "X", "nebula", "Korea");

    @Test
    void wordProcessTest() {
        String result = words.stream()
                .filter(w -> w.length() > 1)
                .map(String::toUpperCase)
                .map(w -> w.substring(0, 1))
                .collect(Collectors.joining(" "));

        assertThat(result).isEqualTo("T H A N K");
    }
}
```

## 장점

1. 함수형 코드는 명령형 코드에 비해 더 간결하다. (함수를 값처럼 활용하면 추상화가 가능하므로)
2. 다중 스레드를 이용해도 안전하다. 불변 데이터 구조를 사용하고 순수 함수를 그 데이터 구조에 적용한다면 다중 스레드 환경에서 같은 데이터를 여러 스레드가 변경할 수 없다.
3. 테스트하기 쉽다. 순수 함수를 사용하면 부수 효과가 일어나지 않기 때문에 부수 효과에 대한 테스트는 할 필요가 없다.

## 단점

• **학습 곡선**: 함수형 프로그래밍은 명령형 프로그래밍과 상당히 다른 개념과 접근 방식을 사용합니다. 따라서 개발자들이 새로운 개념들, 예를 들어 순수 함수, 불변성, 고차 함수 등을 학습하는 데 시간이 걸릴 수 있습니다.

• **성능**: 함수형 프로그래밍에서는 불변성과 순수 함수를 사용하여 상태 변경을 최소화합니다. 그러나 이로 인해 메모리 사용량이 증가하거나, 가비지 컬렉션 비용이 높아질 수 있습니다. 또한, 재귀를 사용한 경우 스택 오버플로우가 발생할 수도 있습니다.



## 참고
https://mangkyu.tistory.com/111   
https://thebook.io/080208/0008/
https://jinwooe.wordpress.com/2017/12/21/%EB%B6%80%EC%88%98-%ED%9A%A8%EA%B3%BC-side-effect-%EC%B0%B8%EC%A1%B0-%ED%88%AC%EB%AA%85%EC%84%B1-referential-transparency/